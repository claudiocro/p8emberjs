/*! p8emberjs - v0.5.1 - 2012-10-23
* plus8.ch
* Copyright (c) 2012 Claudio Romano; Licensed GPL */
(function(){var e=Ember.Namespace.create();window.P8DS=e,e.ILoadable=Ember.Mixin.create({loaded:!1,loading:!1}),e.Service=Ember.Object.extend({getJSON:function(e,t,n,r){var i=n;jQuery.isFunction(t)&&(r=r||n,i=t,t=undefined);var s=jQuery.getJSON(e,t,function(e){i!==undefined&&i(e)});r!==undefined&&s.error(r)}}),e.Store=Ember.ArrayProxy.extend({content:null,_idIdx:{},init:function(){this._super(),this.set("content",[])},find:function(e){var t=this.get("content");return this._idIdx[e]===undefined?undefined:t.objectAt(this._idIdx[e])},indexOfId:function(e){return this._idIdx[e]},put:function(e){this.pushObject(e),this._idIdx[e.id]=this.get("length")-1}});var t=function(e){var t=e.indexOf("[")+1,n;return e.substring(e.length-2,e.length)!=="[]"&&e.substring(e.length-1,e.length)?(n=e.length-1,e.substr(t,n-t)):undefined},n=function(e){var t=e.indexOf("[");return t<0?e:e.substr(0,t)};e.Model=Ember.Object.extend({properties:null,init:function(){this._super();for(var e=0;e<this.properties.length;e++)this._appendProperty(this.properties[e]);for(var t in this)t.indexOf("additionalProp")===0&&this.appendProperty(this[t])},_appendProperty:function(t){t.substring(t.length-2,t.length)==="[]"?this.set(n(t),Ember.ArrayProxy.create({content:[]})):t.substring(t.length-1,t.length)==="]"&&this.set(n(t),Ember.ArrayProxy.create(e.ILoadable,{content:[]}))},appendProperty:function(e){this.properties.pushObject(e),this._appendProperty(e)},extend:function(e){function r(e){return function(t){return e.create(t)}}for(var i=0;i<this.properties.length;i++){var s=n(this.properties[i]);if(this.properties[i].substring(this.properties[i].length-2,this.properties[i].length)==="[]")e[s]!==undefined&&this.get(s).pushObjects(e[s]);else if(this.properties[i].substring(this.properties[i].length-1,this.properties[i].length)==="]"){if(e[s]!==undefined){var o=t(this.properties[i]),u=Ember.get(this,o,!1)||Ember.get(window,o);this.get(s).pushObjects(e[s].map(r(u)))}}else e[this.properties[i]]!==undefined&&this.set(this.properties[i],e[this.properties[i]])}}})})(),function(){var e=Ember.get;window.P8UI=Ember.Namespace.create();var t=Ember.Namespace.create();window&&(window.P8UI=t),t.TableView=Ember.ContainerView.extend({tagName:"table",content:null,columns:null,columnsMeta:null,classNames:["p8ui-tableView"],childViews:["headerView","bodyView"],clickItem:null}),t.TableView.reopen({headerView:Ember.computed(function(){return Ember.View.create({tagName:"thead",columns:e(this,"columns"),columnsMeta:e(this,"columnsMeta"),template:Ember.computed(function(){var t="<tr>";for(var n=0;n<this.get("columns").length;n++){var r=this.get("columns")[n];t+='<th class="col-'+n+'"',e(this,"columnsMeta."+r+".headerWidth")!==undefined&&e(this,"columnsMeta."+r+".headerWidth")&&(t+=' style="width: '+e(this,"columnsMeta."+r+".headerWidth")+';"'),t+=">",e(this,"columnsMeta."+r+".headerValue")!==undefined&&e(this,"columnsMeta."+r+".headerValue")!==null?t+=e(this,"columnsMeta."+r+".headerValue"):t+=r,t+="</th>"}return t+="</tr>",Ember.Handlebars.compile(t)})})}).property(),bodyView:Ember.computed(function(){return t.CollectionView.create({clickItem:this.get("clickItem"),content:Ember.computed(function(){return e(this.get("tableView"),"content")}).property("tableView.content.@each").cacheable(),tableView:this,columns:e(this,"columns")})}).property()}),t.CollectionView=Ember.CollectionView.extend({tagName:"tbody",clickItem:null,itemViewClass:Ember.View.extend({template:Ember.computed(function(){var e="";for(var t=0;t<this.get("parentView.columns").length;t++)e+='<td {{action "_clickItem" target="view" on="click"}}  class="col-'+t+'"><p>{{view.content.'+this.get("parentView.columns")[t]+"}}</p></td>";return Ember.Handlebars.compile(e)}),_clickItem:function(){this.get("parentView").clickItem!==null&&this.get("parentView").clickItem(this.get("content"))}})}),t.ScrollView=Ember.View.extend({classNames:["p8ui-scrollView"],alignBottomTo:null,_TO:!1,_resize:function(){var e=this,t=e.get("alignBottomTo");if(t!==null){var n=e.$().parents(t).filter(":first");e.$().css({height:n.height()-e.$().offset().top+n.offset().top}),e.$().mCustomScrollbar("update")}},_windowResizeListener:function(e){e.data.scrollView._TO!==!1&&clearTimeout(e.data.scrollView._TO),e.data.scrollView._TO=setTimeout(e.data.scrollView._resize.call(e.data.scrollView),200)},didInsertElement:function(){var e=this;setTimeout(function(){e.$().mCustomScrollbar({set_width:!1,set_height:!1,scrollInertia:550,scrollEasing:"easeOutCirc",mouseWheel:"auto",autoDraggerLength:!0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:20,scrollAmount:40},advanced:{updateOnBrowserResize:!1,updateOnContentResize:!1,autoExpandHorizontalScroll:!1},callbacks:{onScroll:function(){},onTotalScroll:function(){},onTotalScrollOffset:0}}),setTimeout(function(){e._resize.call(e)},200);var t=e.get("alignBottomTo");t!==null&&jQuery(window).bind("resize",{scrollView:this},e._windowResizeListener)},200)},willDestroyElement:function(){jQuery(window).unbind("resize",this._windowResizeListener)}})}();